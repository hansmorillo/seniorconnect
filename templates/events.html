{% extends "base.html" %}

{% block content %}
<div class="container my-5">
    <h2 class="mb-4 text-center text-primary">Community Events</h2>
    <p class="text-center">Explore upcoming community events available for RSVP.</p>

    <div class="row g-4 mt-4">
        {% for event in events %}
        <div class="col-md-4">
            <div class="card shadow-sm h-100">
                <img src="{{ url_for('events.uploaded_file', filename=event.image_url) 
                            if event.image_url 
                            else url_for('static', filename='images/default_event.jpg') }}"
                    class="card-img-top"
                    alt="{{ event.name }}">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">{{ event.name }}</h5>
                    <p class="card-text">{{ event.description }}</p>
                    <ul class="list-unstyled mb-3">
                        <li>ğŸ“… <strong>Date:</strong> {{ event.date_time.strftime('%A, %B %d, %Y') }}</li>
                        <li>â° <strong>Time:</strong> {{ event.date_time.strftime('%I:%M %p') }}</li>
                        <li>ğŸ“ <strong>Location:</strong> {{ event.location }}</li>
                    </ul>

                    <form action="{{ url_for('event.toggle_rsvp', event_id=event.id) }}" method="POST" class="mt-auto">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <button type="submit" class="btn {% if event.id in user_rsvps %}btn-danger{% else %}btn-primary{% endif %} w-100">
                            {% if event.id in user_rsvps %}Cancel RSVP{% else %}Sign Up{% endif %}
                        </button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
